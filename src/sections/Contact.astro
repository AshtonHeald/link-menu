---
import FormInput from "../components/FormInput.astro";
---
<article class="px-2.5 py-2 my-3 absolute inset-0 h-fit w-full rounded-md bg-neutral-50 border-2 border-neutral-950 [transform:rotateY(180deg)] [backface-visibility:hidden]">
  <div class="flex justify-between items-end mb-2">
    <h3 class="text-lg leading-4 font-bold">Contact</h3>
    <button
      id="closeBtn"
      class="h-5 w-5 rounded border-2 border-neutral-950 place-items-center transition-colors hover:bg-neutral-200 focus-visible:outline focus-visible:outline-pink-400 focus-visible:outline-2 focus-visible:outline-offset-2 shadow-md" aria-label="Close"
    >
      <img class="h-4 w-4" src="/icons/close.svg" alt="close" />
    </button>
  </div>
  <form id="contact-form">
    <FormInput isInput={true} type="text" id="name" placeholder="Name" label="Name" />
    <FormInput isInput={true} type="email" id="email" placeholder="Email" label="Email" />
    <FormInput isInput={true} type="text" id="subject" placeholder="Subject" label="Subject" />
    <FormInput isInput={false} rows="5" id="message" placeholder="Message" label="Message" />
    <input id="submit"
      type="submit"
      value="Send Message"
      class="mx-auto mb-3 h-9 w-32 cursor-pointer text-sm leading-3 rounded-full border-2 border-neutral-950 grid place-items-center transition-colors hover:bg-neutral-200 focus-visible:outline focus-visible:outline-pink-400 focus-visible:outline-2 focus-visible:outline-offset-2 shadow-md"
    />
    <div class="text-center text-red-600" id="error-message"></div>
    <div class="text-center text-green-600" id="success-message"></div>
  </form>
</article>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script type="text/javascript">
  (function () {
    emailjs.init("00pWDI9dvQcw8kiAg");
  })();
</script>
<script type="text/javascript">
  window.onload = function () {
    var errorElement = document.getElementById("error-message");
    var successElement = document.getElementById("success-message");

    document.getElementById("contact-form").addEventListener("submit", function (event) {
      event.preventDefault();
      errorElement.innerText = "";
      successElement.innerText = "";

      emailjs.sendForm("contact_service", "links_form", this).then(
        function () {
          successElement.innerText = "Message Sent Successfully!";
        },
        function (error) {
          errorElement.innerText = "Unable to send message. Please try again later.";
          console.log(error);
        }
      );
    });
  };
</script>

<style is:global>
	form input:-webkit-autofill,
	form input:-webkit-autofill:focus {
		transition:
			background-color 600000s 0s,
			color 600000s 0s;
	}
	form input[data-autocompleted] {
		background-color: #262626 !important;
	}
	form label {
		left: 0;
		top: 9px;
		pointer-events: none;
	}
	form input:focus ~ label,
	form textarea:focus ~ label,
	form input:not(:placeholder-shown) ~ label,
	form textarea:not(:placeholder-shown) ~ label {
		background: rgb(250, 250, 250);
		top: 1px;
		left: 6px;
		display: block;
		line-height: 1;
		font-size: 12px;
		padding: 0 2px !important;
		color: rgb(23 23 23);
		font-weight: 600;
	}

	input[type="text"]:-moz-placeholder,
	input[type="email"]:-moz-placeholder {
		color: rgb(250, 250, 250);
	}
	input[type="text"]::-moz-placeholder,
  input[type="email"]::-moz-placeholder,
  textarea[id="message"]::-moz-placeholder {
		color: rgb(250, 250, 250);
	}
	input[type="text"]:-ms-input-placeholder {
		color: rgb(250, 250, 250);
	}
	input[type="text"]::-webkit-input-placeholder,
	input[type="email"]::-webkit-input-placeholder,
	textarea[id="message"]::-webkit-input-placeholder {
		color: transparent;
	}
</style>